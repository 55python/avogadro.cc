<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin SEO -->









<title>Compiling on Windows with MSVC 2008 - Avogadro</title>




<meta name="description" content="These instructions are to allow users to build Avogadro from the very latest code. Be aware that Avogadro may fail to build or work properly at any given time when built from the instructions below.">




<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Avogadro">
<meta property="og:title" content="Compiling on Windows with MSVC 2008">


  <link rel="canonical" href="https://avogadro.org/developer/compiling_on_windows_with_msvc_2008/">
  <meta property="og:url" content="https://avogadro.org/developer/compiling_on_windows_with_msvc_2008/">



  <meta property="og:description" content="These instructions are to allow users to build Avogadro from the very latest code. Be aware that Avogadro may fail to build or work properly at any given time when built from the instructions below.">



  <meta name="twitter:site" content="@AvogadroChem">
  <meta name="twitter:title" content="Compiling on Windows with MSVC 2008">
  <meta name="twitter:description" content="These instructions are to allow users to build Avogadro from the very latest code. Be aware that Avogadro may fail to build or work properly at any given time when built from the instructions below.">
  <meta name="twitter:url" content="https://avogadro.org/developer/compiling_on_windows_with_msvc_2008/">

  
    <meta name="twitter:card" content="summary">
    
  

  



  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2017-02-04T11:24:08-05:00">








  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Avogadro Chemistry",
      "url" : "https://avogadro.org",
      "sameAs" : null
    }
  </script>






<!-- end SEO -->


<link href="https://avogadro.org/feed.xml" type="application/atom+xml" rel="alternate" title="Avogadro Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="https://avogadro.org/assets/css/main.css">

<meta http-equiv="cleartype" content="on">
    <!-- start custom head snippets -->





<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--default">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="https://avogadro.org/">Avogadro</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://sourceforge.net/projects/avogadro/files/latest/download">Download</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://avogadro.org/docs/">Manual</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://discuss.avogadro.cc">Discuss</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://avogadro.org/credits/">Thanks</a></li>
          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    <p>These instructions are to allow users to build Avogadro from the very latest code. Be aware that Avogadro may fail to build or work properly at any given time when built from the instructions below.</p>

<p>Compiling Avogadro for Windows is a complex task and it is recommended that you download the pre-made installer found on the download page. For the adventurous, here are Windows Visual Studio 2008 instructions that may or may not work. For various steps in the process, there may be downloadable binaries on the web. However, for completeness we build all dependencies.</p>

<p>There are also <a href="Compiling_on_Linux_and_Mac_OS_X" title="wikilink">instructions for Linux and Mac OS X</a> available.</p>

<h1 id="debugview">DebugView</h1>

<p><a href="http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx">DebugView</a> is a small program that allows you to view qDebug() output.</p>

<h1 id="windows-visual-studio-2008-express">Windows Visual Studio 2008 (Express)</h1>

<p>NOTE: The redistributable manifest and the version Avogadro compile against do not match. This means that the redistributable’s manifest must be altered in order to successfully use the redistributable DLLs. Go to “C:\Program Files\Microsoft Visual Studio 9.0\VC\redist\x86\Microsoft.VC90.CRT” and edit the file called “Microsoft.VC90.CRT.manifest”. I used the version string,</p>

<div class="highlighter-rouge"><pre class="highlight"><code>version="9.0.21022.8"
</code></pre>
</div>

<p>After I changed that then the DLLs were successfully loaded and the mysterious error message stopped popping up. This was with the standard “free” version downloaded in January 2009.</p>

<h2 id="dependencies">Dependencies</h2>

<p>Required:</p>

<p><a href="http://www.cmake.org">CMake</a> (&gt;=2.6.0)
[Qt4](
[Eigen](
[OpenBabel](</p>

<p>For optional OpenGL shader support:</p>

<p><a href="http://glew.sourceforge.net/">GLEW</a></p>

<p>For the optional Python console/bindings:</p>

<p><a href="http://www.riverbankcomputing.co.uk/software/pyqt/download">PyQt4</a>
<a href="http://www.riverbankcomputing.co.uk/software/sip/download">SIP</a>
<a href="http://www.boostpro.com/products/free">Boost libraries</a> (tested with &gt;=1.36.0, older versions likely work fine)
<a href="http://www.boost.org/users/download/">Boost</a></p>

<p>The instructions below are based on <a href="http://wiki.qtcentre.org/index.php?title=Qt4_with_Visual_Studio">Qt4 with Visual Studio</a>. Extract and build Qt4 in the C:\src\qt-&lt;version&gt; directory (e.g. C:\src\qt-4.5.1 for version 4.5.1).</p>

<p>Compiling Qt takes some time and can require +10GB free disk space. Below are some options to run configure.exe that reduce compile time and disk space requirements.</p>

<p><code class="highlighter-rouge">-release or -debug : default is -debug-and-release which takes more disk spcace.</code>
<code class="highlighter-rouge">Unused (by Avogadro) Qt components:</code>
<code class="highlighter-rouge">-no-webkit</code>
<code class="highlighter-rouge">-no-phonon</code>
<code class="highlighter-rouge">-no-phonon-backend</code>
<code class="highlighter-rouge">-no-qt3support</code></p>

<p>A full compile &amp; installation could look like (in command prompt):</p>

<p><code class="highlighter-rouge">cd c:\src\qt-4.5.1</code>
<code class="highlighter-rouge">configure.exe -opensource -no-webkit -release </code>
<code class="highlighter-rouge">...</code>
<code class="highlighter-rouge">Do you accept the terms of the license?</code>
<code class="highlighter-rouge">y</code>
<code class="highlighter-rouge">nmake</code>
<code class="highlighter-rouge">nmake install</code></p>

<ul>
  <li>Add C:\src\qt-4.5.1\lib to your PATH. (Control Panel-&gt;System-&gt;Advanced Tab-&gt;Environment Variables)</li>
  <li>Make sure qmake.exe is somewhere in your PATH (needed to build PyQt)</li>
</ul>

<p>Download <a href="http://eigen.tuxfamily.org">Eigen 2 here</a>. There is no need to build Eigen since it’s a template library consisting of headers only. We simply extract the files to C:\src\eigen-2.0.1. You should now have the Eigen headers in C:\src\eigen-2.0.1\Eigen</p>

<ul>
  <li>Download <a href="http://www.winimage.com/zLibDll/">zetlib123.zip here</a></li>
  <li>Extract to C:\src\zlib-1.2.3</li>
  <li>Open C:\src\zlib-1.2.3\projects\visualc6\zlib.sln (<strong>note:</strong> This will convert the VC6.0 solution…)</li>
  <li>Select the <strong>DLL Release</strong> configuration</li>
  <li>Build (F7)</li>
</ul>

<p>The zlib library files are now in C:\src\zlib-1.2.3\projects\visualc6\Win32_DLL_Release. The zlib.h header file is in C:\src\zlib-1.2.3.</p>

<ul>
  <li>Download <a href="ftp://xmlsoft.org/libxml2/">libxml2-sources-2.7.3.tar.gz here</a></li>
  <li>Extract to C:\src\libxml2-2.7.3</li>
  <li>
    <p>In command prompt:</p>

    <p>cd c:\src\libxml2-2.7.3\win32</p>

    <p>cscript configure.js compiler=msvc prefix=c:\local\libxml2 iconv=no zlib=yes include=c:\src\zlib-1.2.3 lib=c:\src\zlib-1.2.3\projects\visualc6\Win32_DLL_Release</p>
  </li>
  <li>Edit Makefile.msvc: change “zdll.lib” to “zlib1.lib”</li>
  <li>
    <p>In command prompt again:</p>

    <p>nmake /f Makefile.msvc</p>

    <p>nmake /f Makefile.msvc install</p>
  </li>
</ul>

<p>Although boost is an optional dependency for OpenBabel, it is recommended to compile with boost. OpenBabel only needs headers from the boost libraries and extracting the source package to C:\src is enough for now. If you intend to build Avogadro with python support you need build boost python later (see below).</p>

<p>Download openbabel 2.2.1 if you haven’t already and extract it to C:\src</p>

<p>Since we are using cmake 2.6, the installed <a href="http://www.boostpro.com/products/free">boost libraries</a> will be found automatically. If you downloaded the boost source, make sure to also set Boost_INCLUDE_DIR. OpenBabel only uses headers from boost, there is no need to compile any boost libraries before building OpenBabel.</p>

<p><code class="highlighter-rouge">cd c:\openbabel</code>
<code class="highlighter-rouge">mkdir build</code>
<code class="highlighter-rouge">cd build</code>
<code class="highlighter-rouge">cmake -DCMAKE_BUILD_TYPE="Release" -DZLIB_INCLUDE_DIR=c:\openbabel\include -DZLIB_LIBRARY=c:\openbabel\windows-vc2005\zlib1.lib</code>
<code class="highlighter-rouge">-DLIBXML2_INCLUDE_DIR=c:\openbabel\include -DLIBXML2_LIBRARIES=c:\openbabel\windows-vc2005\libxml2.lib </code>
<code class="highlighter-rouge">-DLIBRARY_OUPUT_PATH=c:\openbabel\output -DEXECUTABLE_OUPUT_PATH=c:\openbabel\output -G "Visual Studio 9 2008" ..</code></p>

<p><img src="Cmake.jpg" alt="openbabel CMake 2.6 setting for windows" title="openbabel CMake 2.6 setting for windows" /></p>

<ol>
  <li>Open the CMake GUI: Start &gt; All programs &gt; CMake 2.6 &gt; cmake-gui(beta)</li>
  <li>Set the “Where is the source code” field to C:/openbabel</li>
  <li>Set the “Where to build the binaries” field to C:/openbabel/build</li>
  <li>Press the “Configure” button</li>
  <li>A new dialog will appear where you can select the build environment: Visual Studio 9 2008</li>
  <li>Set the combo box (on the right of the search field) to “Grouped View”</li>
  <li>
    <p>Edit the ZLIB and LIBXML2 fields so they resemble the screenshot</p>
  </li>
  <li>Open the C:\openbabel\build\openbabel.sln solution</li>
  <li>Select the <strong>Release</strong> solution configuration.</li>
  <li>Build the Solution (F7)</li>
</ol>

<p>You should now have all files files in C:\openbabel\output\Release.</p>

<h2 id="building-avogadro">Building Avogadro</h2>

<p>For a minimal build (no python &amp; GLSL shaders), you can now proceed to build Avogadro. If you want python and/or GLSL shader support, build these dependencies first and come back to this step later.</p>

<p>Download Avogadro <a href="http://github.com/cryos/avogadro/zipball/master">trunk</a> or <a href="http://github.com/cryos/avogadro/doawnloads">a stable version</a> and uncompress it to the C:\src\avogadro directory.</p>

<ul>
  <li>Edit the scripts\cmake-msvc2008.bat file to make sure all paths are correct.</li>
  <li>Open the Visual Studio 2008 Command Prompt.</li>
</ul>

<p><code class="highlighter-rouge">cd C:\src\avogadro</code>
<code class="highlighter-rouge">mkdir build</code>
<code class="highlighter-rouge">cd build</code>
<code class="highlighter-rouge">..\scripts\cmake-msvc2008.bat</code>
<code class="highlighter-rouge">nmake</code></p>

<h2 id="running-avogadro--building-the-installer">Running Avogadro &amp; Building the Installer</h2>

<p>The easiest way to run avogadro is to build a binary zip file or <a href="http://nsis.sourceforge.net">NSIS installer</a>.</p>

<p>If you have set the CPACK_BINARY_ZIP or CPACK_BINARY_NSIS variable when running cmake (see scripts/cmake-msvc2008.bat), all you have to do is:</p>

<ul>
  <li>In command prompt:</li>
</ul>

<p><code class="highlighter-rouge">nmake PACKAGE</code></p>

<p>This will generate a zip file or .exe installer in your build dir. Simply extract or install and run avogadro.exe.</p>

<h2 id="glsl-shader-support-optional">GLSL Shader Support (Optional)</h2>

<ul>
  <li>GLEW-1.5.1: <a href="http://ovh.dl.sourceforge.net/sourceforge/glew/glew-1.5.1-src.zip">http://ovh.dl.sourceforge.net/sourceforge/glew/glew-1.5.1-src.zip</a></li>
  <li>Extract to C:\src</li>
  <li>Open C:\src\glew\build\vc6\glew.sln (<strong>note:</strong> This will convert the VC6.0 solution…)</li>
  <li>Select <strong>Release</strong> configuration</li>
  <li>Build the <strong>glew_shared</strong> target</li>
</ul>

<h2 id="python-support-optional">Python Support (Optional)</h2>

<ul>
  <li>Python 2.6.2: <a href="http://www.python.org/ftp/python/2.6.2/Python-2.6.2.tar.bz2">http://www.python.org/ftp/python/2.6.2/Python-2.6.2.tar.bz2</a>
    <ul>
      <li>Extract to C:\src</li>
      <li>Open c:\src\Python-2.6.2\PCbuild\pcbuild.sln (<strong>note:</strong> when using VC++ 2008 express, you’ll get an error message saying “solution folders” aren’t supported. You can safely ignore this.)</li>
      <li>Select <strong>Release</strong></li>
      <li>Build (F7)</li>
      <li>You now have the files in the PCBuild directory</li>
      <li>Copy the exe, lib, dll &amp; pyd files to c:\src\Python-2.6.2\libs</li>
      <li>Copy C:\src\Python-2.6.2\PC\pyconfig.h to C:\src\Python-2.6.2\Include</li>
    </ul>
  </li>
</ul>

<p>Some targets (7 for 2.6.2) fail because they need additional libraries (encryption, sqlite3, …). This is not a problem since we don’t use these parts.</p>

<ul>
  <li>bjam precompiled: <a href="http://sourceforge.net/project/showfiles.php?group_id=7586&amp;package_id=72941">http://sourceforge.net/project/showfiles.php?group_id=7586&amp;package_id=72941</a>
    <ul>
      <li>place bjam.exe in a directory in your PATH (e.g. C:\Windows) (<strong>note:</strong> typing PATH at the MSVC command prompt show your current PATH values)</li>
    </ul>
  </li>
  <li>boost libraries (1.38): <a href="http://sourceforge.net/project/showfiles.php?group_id=7586&amp;package_id=8041">http://sourceforge.net/project/showfiles.php?group_id=7586&amp;package_id=8041</a>
    <ul>
      <li>Extract to C:\src</li>
      <li>Edit C:\src\boost_1_38_0\tools\build\v2\user-config.jam</li>
      <li>Add (at the end for example):</li>
    </ul>
  </li>
</ul>

<p><code class="highlighter-rouge">using python</code>
<code class="highlighter-rouge">  : 2.6</code>
<code class="highlighter-rouge">  : C:/src/Python-2.6.2/libs/python 
</code>  : C:/src/Python-2.6.2/Include     
`  : C:/src/Python-2.6.2/libs ;      </p>

<p>In command promt:</p>

<p><code class="highlighter-rouge">cd C:\src\boost_1_38_0</code>
<code class="highlighter-rouge">mkdir build</code>
<code class="highlighter-rouge">bjam --build-dir="build" --toolset=msvc --with-python stage</code></p>

<p>You now have the following files in <strong>$BOOST_ROOT/stage/lib</strong>:</p>

<p><code class="highlighter-rouge">boost_python-vc90-mt.lib               185kB</code>
<code class="highlighter-rouge">boost_python-vc90-mt-1_38.dll          210kB</code>
<code class="highlighter-rouge">boost_python-vc90-mt-1_38.lib          185kB  
</code>libboost_python-vc90-mt.lib            5173kB <code class="highlighter-rouge">
</code>libboost_python-vc90-mt-1_38.lib       5173kB </p>

<p>Copy the files above to <strong>$BOOST_ROOT/lib</strong>, the CPack script expects to find them there</p>

<ul>
  <li><a href="http://www.riverbankcomputing.co.uk/static/Downloads/sip4/sip-4.7.9.zip">http://www.riverbankcomputing.co.uk/static/Downloads/sip4/sip-4.7.9.zip</a>
    <ul>
      <li>Extract to C:\src</li>
    </ul>
  </li>
</ul>

<p>In command prompt:</p>

<p><code class="highlighter-rouge">cd c:\src\sip-4.7.9</code>
<code class="highlighter-rouge">C:\src\Python-2.6.2\libs\python.exe configure.py</code>
<code class="highlighter-rouge">nmake</code></p>

<p>You now have these files:</p>

<p><code class="highlighter-rouge">C:\src\sip-4.7.9\sipconfig.py</code>
<code class="highlighter-rouge">C:\src\sip-4.7.9\siplib\sip.h</code>
<code class="highlighter-rouge">C:\src\sip-4.7.9\siplib\sip.pyd</code>
<code class="highlighter-rouge">C:\src\sip-4.7.9\siplib\sip.pyd.manifest</code>
<code class="highlighter-rouge">C:\src\sip-4.7.9\sipgen\sip.exe</code>
<code class="highlighter-rouge">C:\src\sip-4.7.9\sipgen\sip.exe.manifest</code></p>

<ul>
  <li>Copy <strong>sipconfig.py</strong>, <strong>sip.pyd</strong> and <strong>sip.pyd.manifest</strong> to C:\src\Python-2.6.2\lib\site-packages\</li>
  <li>Copy file <strong>sip.h</strong> to C:\src\Python-2.6.2\Include</li>
  <li>Copy files <strong>sip.exe</strong> and <strong>sip.exe.manifest</strong> to C:\src\Python-2.6.2</li>
</ul>

<p>Notes:</p>

<ul>
  <li>sip.exe[.manifest] is only needed to build PyQt4, no need to include it in the installer</li>
  <li>sip.h is also needed to build Avogadro</li>
</ul>

<p>Assumes Qt is in C:\Qt\4.4.3, change this if needed…</p>

<ul>
  <li>PyQt4 4.4.4: <a href="http://www.riverbankcomputing.co.uk/static/Downloads/PyQt4/PyQt-win-gpl-4.4.4.zip">http://www.riverbankcomputing.co.uk/static/Downloads/PyQt4/PyQt-win-gpl-4.4.4.zip</a>
    <ul>
      <li>Extract to C:\src</li>
    </ul>
  </li>
</ul>

<p>In command prompt:</p>

<p><code class="highlighter-rouge">cd C:\src\PyQt-win-gpl-4.4.4</code>
<code class="highlighter-rouge">mkdir release</code>
<code class="highlighter-rouge">copy C:\Qt\4.4.3\lib\QtCore4.dll release\QtCore4.dll</code>
<code class="highlighter-rouge">C:\src\Python-2.6.2\libs\python.exe configure.py</code>
<code class="highlighter-rouge">nmake</code></p>

<p>You now have the .pyd files and their manifests in the Qt* dirs:</p>

<p><code class="highlighter-rouge">C:\src\PyQt-win-gpl-4.4.4\Qt\Qt.pyd(.manifest)</code>
<code class="highlighter-rouge">C:\src\PyQt-win-gpl-4.4.4\QtCore\QtCore.pyd(.manifest)</code>
<code class="highlighter-rouge">C:\src\PyQt-win-gpl-4.4.4\QtGui\QtGui.pyd(.manifest)</code>
<code class="highlighter-rouge">C:\src\PyQt-win-gpl-4.4.4\QtOpenGL\QtOpenGL.pyd(.manifest)</code>
<code class="highlighter-rouge">...</code></p>

<p>You can leave the files there, the CPack script will include them in the package.</p>

<ul>
  <li>Numpy 1.3.0: <a href="http://kent.dl.sourceforge.net/sourceforge/numpy/numpy-1.3.0.tar.gz">http://kent.dl.sourceforge.net/sourceforge/numpy/numpy-1.3.0.tar.gz</a>
    <ul>
      <li>Extract to C:\src</li>
    </ul>
  </li>
</ul>

<p>In command prompt:</p>

<p><code class="highlighter-rouge">cd c:\src\numpy-1.3.0</code>
<code class="highlighter-rouge">c:\src\Python-2.6.2\libs\python.exe setup.py install</code></p>

<p>This will install numpy to the <strong>C:/src/Python-2.6.2/lib/site-packages</strong> directory</p>

<p>numpy/arrayobject.h is in <strong>C:/src/Python-2.6.2/lib/site-packages/numpy/core/include</strong> (You’ll need this to build Avogadro)</p>



    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->
<a href="//github.com/avogadro/Avogadro.github.io/edit/master/_developer/compiling_on_windows_with_msvc_2008.md">Edit this on GitHub</a>
<!-- end custom footer snippets -->

        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
      <li><a href="https://twitter.com/AvogadroChem"><i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
    
    
    
      <li><a href="http://github.com/avogadro"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <li><a href="https://avogadro.org/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2017 Avogadro Chemistry. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>
      </footer>
    </div>

    <script src="https://avogadro.org/assets/js/main.min.js"></script>





  

<script type="text/javascript">
    DiscourseEmbed = { discourseUrl: '//discuss.avogadro.cc/',
                       discourseEmbedUrl: 'https://avogadro.org/developer/compiling_on_windows_with_msvc_2008/' };
   (function () {
     var d = document.createElement('script'); d.type = 'text/javascript'; d.async = true;
     d.src = DiscourseEmbed.discourseUrl + 'javascripts/embed.js';
     (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(d);
   })();
</script>
<noscript>Please enable JavaScript to view the comments powered by <a href="https://www.discourse.org/">Discourse.</a></noscript>







  </body>
</html>
